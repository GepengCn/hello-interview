在Java中，`HashMap` 的 `put` 操作用于将键值对添加到哈希表中。这个过程涉及几个关键步骤，包括计算键的哈希码、定位键在哈希表中的位置，以及处理可能的哈希冲突。以下是 `put` 操作的具体步骤：

### 1. 计算哈希码
首先，`put` 方法会调用键对象的 `hashCode()` 方法来计算其哈希码。这个哈希码是确定键在哈希表中位置的基础。

### 2. 应用扰动函数
为了减少哈希碰撞并更均匀地分布数据，`HashMap` 会对计算出的哈希码应用扰动函数，进一步处理哈希码。在JDK 8及之后版本中，这通常是通过哈希码的高位参与运算来实现的，例如通过 `h ^ (h >>> 16)`，其中 `h` 是原始哈希码，`>>>` 是无符号右移操作。

### 3. 定位桶位置
接下来，`put` 方法会使用处理过的哈希码与当前哈希表大小进行位与操作（例如 `hash & (n-1)`，其中 `n` 是哈希表的大小），以确定键应该存放在哪个桶（bucket）中。

### 4. 处理哈希冲突
- 如果所定位的桶为空，`put` 方法会在该桶位置创建一个新的节点存储键值对。
- 如果桶非空，`put` 方法会检查桶中的链表或红黑树，看是否有与待插入键相等的节点（即键的 `equals()` 方法返回 `true`）：
- 如果找到相等的键，其对应的值将被新值替换。
- 如果没有找到相等的键，`put` 方法会在链表的末尾或红黑树中适当的位置添加一个新节点。

### 5. 检查并执行扩容
在添加新节点后，如果哈希表的大小达到了负载因子与当前容量的乘积，`HashMap` 会进行扩容操作。这涉及创建一个新的哈希表（通常是原来大小的两倍），并将所有旧哈希表中的元素重新哈希到新表中。

### 6. 返回旧值（如果存在）
如果在哈希表中已经有与待插入键相等的节点，`put` 方法会返回该键之前关联的旧值。否则，返回 `null`。

### 总结
`HashMap` 的 `put` 操作是一个细致的过程，涉及到哈希码的计算、扰动、定位桶位置、处理哈希冲突和可能的扩容。这些步骤共同保证了 `HashMap` 的高效性和键值对的正确存储。在并发环境下，还需要考虑额外的同步措施，或者使用 `ConcurrentHashMap` 来保证线程安全。